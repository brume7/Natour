extends base

block append head
  script(src='https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.js')
  link(href='https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.css' rel='stylesheet')

block content
  main.mb-4
    section.bg-white 
      div(class='mx-auto  h-[500px]  relative')
        .header__hero
          .header__hero-overlay &nbsp;
          img.header__hero-img(src='/img/tours/'+tour.imageCover, alt=tour.name)
        .heading-box
          h1.heading-primary
            span(class='text-4xl') #{tour.name} Tour
    section(class='mx-auto max-w-[1440px] px-1 xl:px-0 flex flex-wrap')
      div(class='bg-[#f7f7f7] min-h-full w-full sm:w-1/2 flex flex-col')
        h2.heading-secondary.ma-bt-lg Quick facts
          .overview-box__detail(class='mt-[30px]')
            svg.overview-box__icon
              use(xlink:href='/img/icons.svg#icon-calendar')
            span.overview-box__label Next date
            span.overview-box__text #{(new Date(tour.startDates[0])).toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}
          .overview-box__detail
            svg.overview-box__icon
              use(xlink:href='/img/icons.svg#icon-trending-up')
            span.overview-box__label Difficulty
            span.overview-box__text #{tour.difficulty}
          .overview-box__detail
            svg.overview-box__icon
              use(xlink:href='/img/icons.svg#icon-user')
            span.overview-box__label Participants
            span.overview-box__text #{tour.maxGroupSize} people
          .overview-box__detail
            svg.overview-box__icon
              use(xlink:href='/img/icons.svg#icon-star')
            span.overview-box__label Rating
            span.overview-box__text #{tour.ratingsAverage} / 5
          h2.heading-secondary.ma-bt-lg Your tour guides
            each guide in tour.guides
              .overview-box__detail(class='mt-[30px]')
                img.overview-box__img(src='/img/users/'+guide.photo alt='Lead guide')
                - if (guide.role == 'lead-guide')
                  span.overview-box__label Lead guide
                - if (guide.role == 'guide')
                  span.overview-box__label Tour guide
                span.overview-box__text #{guide.name}
      div(class='bg-[#fcfcfc] min-h-full  w-full sm:w-1/2 flex flex-col items-center px-4')
        h2.heading-secondary.ma-bt-lg About #{tour.name} tour
        p.description__text.text-2xl.font-semibold #{tour.description}
    section.section-pictures
      each image, i in tour.images
        .picture-box
          img.picture-box__img(src='/img/tours/'+image, alt=`${tour.name} ${image}`, class=`picture-box__img--${i+1}`)
    section.section-map
      #map(data-locations=`${JSON.stringify(tour.locations)}`)
    section.section-reviews
      .reviews
        each review in tour.reviews
          .reviews__card
            .reviews__avatar
              img.reviews__avatar-img(src=`${review.user.photo ? '/img/users/'+review.user.photo : '/img/users/default.jpg'}`, alt=review.user.name)
              h6.reviews__user #{review.user.name}
            p.reviews__text #{review.review}
            .reviews__rating
              each star in [1,2,3,4,5]
                svg(class=`reviews__star reviews__star--${star <= review.rating ? 'active':'inactive'}`)
                  use(xlink:href='/img/icons.svg#icon-star')
    section.section-cta
      .cta(class='mx-auto max-w-[1440px] px-2')
        .cta__img.cta__img--logo
          img(src='/img/logo-white.png' alt='Natours logo')
        each image, i in tour.images
          - if ((i+1) <=2) {
          img(src='/img/tours/'+image alt='', class=`cta__img cta__img--${i+1}`)
          -}
        .cta__content(class='text-center pl-[200px]')
          h2.heading-secondary What are you waiting for?
          p.cta__text #{tour.duration} days. 1 adventure. Infinite memories. Make it yours today!
          button.btn.btn--green.span-all-rows Book tour now!

block append scripts
  script(src="/js/mapbox.js") 